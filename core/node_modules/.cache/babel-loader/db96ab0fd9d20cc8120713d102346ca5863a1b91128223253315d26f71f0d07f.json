{"ast":null,"code":"import auth from '@/assets/auth';\nimport 'vue-good-table/dist/vue-good-table.css';\nimport { VueGoodTable } from 'vue-good-table';\nimport Multiselect from 'vue-multiselect';\nexport default {\n  name: 'CouponsManagement',\n  components: {\n    VueGoodTable,\n    Multiselect\n  },\n  data() {\n    return {\n      couponToEdit: null,\n      couponsList: [],\n      usersList: [],\n      speakersList: [],\n      columns: [{\n        label: 'Coupon',\n        field: 'coupon_title'\n      }, {\n        label: 'Discount %',\n        field: 'discount'\n      }, {\n        label: 'Recipient',\n        field: 'recipient_name'\n      }, {\n        label: 'For guests?',\n        field: this.guestCheck\n      }, {\n        label: 'Invitation type',\n        field: 'invitation_type'\n      }, {\n        label: 'Invitation display',\n        field: this.headlinersCheck\n      }, {\n        label: 'Max uses',\n        field: 'max_uses'\n      }, {\n        label: 'Actual uses',\n        field: 'actual_uses'\n      }, {\n        label: 'View/Edit',\n        field: 'edit'\n      }]\n    };\n  },\n  methods: {\n    async grabCoupons() {\n      this.couponsList = [];\n      const url = auth.allCoupons;\n      const headers = {\n        credentials: 'same-origin',\n        'Content-Type': 'application/json',\n        'X-WP-Nonce': this.nonce\n      };\n      fetch(url, {\n        method: 'GET',\n        headers\n      }).then(result => result.json()).then(result => {\n        this.couponsList = result;\n      });\n    },\n    async grabUsers() {\n      this.usersList = [];\n      const url = auth.peopleAndOrgs;\n      const headers = {\n        credentials: 'same-origin',\n        'Content-Type': 'application/json',\n        'X-WP-Nonce': this.nonce\n      };\n      fetch(url, {\n        method: 'GET',\n        headers\n      }).then(result => result.json()).then(result => {\n        this.usersList = result;\n      });\n    },\n    async grabSpeakers() {\n      this.usersList = [];\n      const url = auth.onlyPeople;\n      const headers = {\n        credentials: 'same-origin',\n        'Content-Type': 'application/json',\n        'X-WP-Nonce': this.nonce\n      };\n      fetch(url, {\n        method: 'GET',\n        headers\n      }).then(result => result.json()).then(result => {\n        this.speakersList = result;\n      });\n    },\n    guestCheck(rowObj) {\n      if (rowObj.guest_status === '1') {\n        return 'Yes';\n      }\n      return 'No';\n    },\n    headlinersCheck(rowObj) {\n      if (rowObj.headliners.length >= 1) {\n        return 'Custom';\n      }\n      return 'Standard';\n    },\n    editCoupon(rowId) {\n      this.couponToEdit = this.couponsList[rowId];\n    },\n    startNewCoupon() {\n      this.couponToEdit = {};\n    }\n  },\n  mounted() {\n    this.grabCoupons();\n    this.grabUsers();\n    this.grabSpeakers();\n  }\n};","map":{"version":3,"mappings":"AA8IA;AACA;AACA;AACA;AAEA;EACAA;EACAC;IAAAC;IAAAC;EAAA;EACAC;IACA;MACAC;MACAC;MACAC;MACAC;MACAC,UACA;QACAC;QACAC;MACA,GACA;QACAD;QACAC;MACA,GACA;QACAD;QACAC;MACA,GACA;QACAD;QACAC;MACA,GACA;QACAD;QACAC;MACA,GACA;QACAD;QACAC;MACA,GACA;QACAD;QACAC;MACA,GACA;QACAD;QACAC;MACA,GACA;QACAD;QACAC;MACA;IAEA;EACA;EACAC;IACA;MACA;MACA;MACA;QACAC;QACA;QACA;MACA;MACAC;QAAAC;QAAAC;MAAA,GACAC,8BACAA;QAAA;MAAA;IACA;IACA;MACA;MACA;MACA;QACAJ;QACA;QACA;MACA;MACAC;QAAAC;QAAAC;MAAA,GACAC,8BACAA;QAAA;MAAA;IACA;IACA;MACA;MACA;MACA;QACAJ;QACA;QACA;MACA;MACAC;QAAAC;QAAAC;MAAA,GACAC,8BACAA;QAAA;MAAA;IACA;IACAC;MACA;QACA;MACA;MACA;IACA;IACAC;MACA;QACA;MACA;MACA;IACA;IACAC;MACA;IACA;IACAC;MACA;IACA;EACA;EACAC;IACA;IACA;IACA;EACA;AAEA","names":["name","components","VueGoodTable","Multiselect","data","couponToEdit","couponsList","usersList","speakersList","columns","label","field","methods","credentials","fetch","method","headers","then","guestCheck","headlinersCheck","editCoupon","startNewCoupon","mounted"],"sourceRoot":"src/components","sources":["couponsManagement.vue"],"sourcesContent":["<template>\r\n  <div class=\"sub-section\">\r\n    <message-announce v-if=\"announce\" :message=\"announce\" @closeMessage=\"killMessage()\" />\r\n    <vue-good-table\r\n            :columns=\"columns\"\r\n            :rows=\"couponsList\"\r\n            theme=\"black-rhino\"\r\n            :search-options=\"{\r\n              enabled: true\r\n            }\"\r\n            :pagination-options=\"{\r\n                enabled: true,\r\n                perPage: 50,\r\n                position: 'bottom',\r\n            }\">\r\n            <div slot=\"table-actions\">\r\n              <button class=\"create-new-coupon\" @click=\"startNewCoupon\">\r\n                <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"ionicon\" viewBox=\"0 0 512 512\"><path d=\"M256 48C141.31 48 48 141.31 48 256s93.31 208 208 208 208-93.31 208-208S370.69 48 256 48zm80 224h-64v64a16 16 0 0 1-32 0v-64h-64a16 16 0 0 1 0-32h64v-64a16 16 0 0 1 32 0v64h64a16 16 0 0 1 0 32z\"/></svg>\r\n              </button>\r\n            </div>\r\n            <template slot=\"table-row\" slot-scope=\"props\">\r\n                <span v-if=\"props.column.field == 'edit'\">\r\n                    <button @click=\"editCoupon(props.row.originalIndex)\">Edit</button>\r\n                </span>\r\n            </template>\r\n        </vue-good-table>\r\n\r\n        <div class=\"edit-shelf\" v-if=\"(couponToEdit !== null)\" v-scroll-lock=\"couponToEdit\">\r\n            <div class=\"content-wrap\">\r\n                <span class=\"options-title\">\r\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"ionicon\" viewBox=\"0 0 512 512\"><path d=\"M459.94 53.25a16.06 16.06 0 0 0-23.22-.56L424.35 65a8 8 0 0 0 0 11.31l11.34 11.32a8 8 0 0 0 11.34 0l12.06-12c6.1-6.09 6.67-16.01.85-22.38zM399.34 90 218.82 270.2a9 9 0 0 0-2.31 3.93L208.16 299a3.91 3.91 0 0 0 4.86 4.86l24.85-8.35a9 9 0 0 0 3.93-2.31L422 112.66a9 9 0 0 0 0-12.66l-9.95-10a9 9 0 0 0-12.71 0z\"/><path d=\"M386.34 193.66 264.45 315.79A41.08 41.08 0 0 1 247.58 326l-25.9 8.67a35.92 35.92 0 0 1-44.33-44.33l8.67-25.9a41.08 41.08 0 0 1 10.19-16.87l122.13-121.91a8 8 0 0 0-5.65-13.66H104a56 56 0 0 0-56 56v240a56 56 0 0 0 56 56h240a56 56 0 0 0 56-56V199.31a8 8 0 0 0-13.66-5.65z\"/></svg>\r\n                    <h2>Edit coupon</h2>\r\n                </span>\r\n\r\n                <button class=\"close-button\" @click=\"(couponToEdit = null)\">\r\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"ionicon\" viewBox=\"0 0 512 512\"><path fill=\"none\" stroke=\"currentColor\" stroke-miterlimit=\"10\" stroke-width=\"32\" d=\"M448 256c0-106-86-192-192-192S64 150 64 256s86 192 192 192 192-86 192-192z\"/><path fill=\"none\" stroke=\"currentColor\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"32\" d=\"M320 320 192 192m0 128 128-128\"/></svg>\r\n                </button>\r\n                <form id=\"edit-registrant\">\r\n                    <h2>Coupon details</h2>\r\n                    <input type=\"hidden\" v-model=\"couponToEdit.invitation_post_id\">\r\n                    <div class=\"double\">\r\n                        <label for=\"code\">Coupon code\r\n                        <input type=\"text\" id=\"code\" v-model=\"couponToEdit.coupon_title\"/></label>\r\n\r\n                        <label for=\"lname\">Discount\r\n                        <input type=\"text\" id=\"lname\" v-model=\"couponToEdit.discount\"/></label>\r\n                    </div>\r\n                    <div class=\"double\">\r\n                        <label for=\"max-uses\">Max uses allowed\r\n                            <input type=\"number\" id=\"max-uses\"\r\n                            v-model=\"couponToEdit.max_uses\"/>\r\n                        </label>\r\n                        <label for=\"actual-uses\">Actual uses\r\n                            <input type=\"number\" id=\"actual-uses\"\r\n                            v-model=\"couponToEdit.actual_uses\" disabled/>\r\n                        </label>\r\n                    </div>\r\n\r\n                    <h2>Invitation details</h2>\r\n                    <div class=\"double\">\r\n                        <label for=\"related-post\">Recipient\r\n                        <select name=\"related-post\" v-model=\"couponToEdit.recipient_id\">\r\n                            <option value=\"other\">Other</option>\r\n                            <option v-for=\"(item, index) in usersList\"\r\n                            :value=\"item.id\"\r\n                            :key=\"index\">\r\n                            {{item.name}}\r\n                            </option>\r\n                        </select></label>\r\n\r\n                        <label for=\"other-recipient\" v-show=\"couponToEdit.recipient_id === 'other'\">\r\n                            Other recipient\r\n                            <input type=\"text\"\r\n                                id=\"other-recipient\"\r\n                                v-model=\"couponToEdit.recipient_name\"/>\r\n                        </label>\r\n                    </div>\r\n\r\n                    <label for=\"coupon-type\">Coupon type\r\n                        <select id=\"coupon-type\" v-model=\"couponToEdit.invitation_type\">\r\n                            <option value=\"generic\">Generic coupon</option>\r\n                            <option value=\"Netcomm member\">Netcomm member</option>\r\n                            <option value=\"Dagorà member\">Dagorà member</option>\r\n                            <option value=\"LTCC member\">LTCC member</option>\r\n                            <option value=\"Brand-retailer-manufacturer\">\r\n                                Brand/Retailer/Manufacturer</option>\r\n                            <option value=\"Staff\">Staff</option>\r\n                            <option value=\"Speaker\">Speaker</option>\r\n                            <option value=\"Sponsor\">Sponsor</option>\r\n                            <option value=\"Prospect\">Prospect</option>\r\n                            <option value=\"Institution\">Institution</option>\r\n                            <option value=\"School-university\">School/University</option>\r\n                        </select>\r\n                        </label>\r\n\r\n                        <div class=\"double\">\r\n                        <label for=\"related-post\">Invitation layout\r\n                            <select id=\"coupon-type\" v-model=\"couponToEdit.with_headliners\">\r\n                                <option value=\"standard\">Standard</option>\r\n                                <option value=\"custom\">Custom</option>\r\n                            </select></label>\r\n\r\n                            <span v-show=\"couponToEdit.with_headliners == 'custom'\">\r\n                                Choose who appears on the invitation\r\n                            </span>\r\n                              <multiselect\r\n                                id=\"custom-headliners\"\r\n                                name=\"custom-headliners\"\r\n                                v-show=\"couponToEdit.with_headliners == 'custom'\"\r\n                                v-model=\"couponToEdit.headliners\"\r\n                                :options=\"speakersList\"\r\n                                track-by=\"id\"\r\n                                label=\"name\">\r\n                                </multiselect>\r\n                        </div>\r\n\r\n                    <div class=\"double\">\r\n                        <button v-if=\"couponToEdit.invitation_post_id\"\r\n                        class=\"save-edits form-button\"\r\n                        type=\"button\" @click=\"editCoupon('edit')\">\r\n                        Save edits\r\n                        </button>\r\n                        <button v-else\r\n                        class=\"save-edits form-button\"\r\n                        type=\"button\" @click=\"editCoupon('create')\">\r\n                        Save edits\r\n                        </button>\r\n                        <button\r\n                        v-if=\"couponToEdit.id\"\r\n                        class=\"delete-registration form-button\"\r\n                        type=\"button\"\r\n                        @click=\"editCoupon('delete')\">\r\n                        Delete coupon\r\n                        </button>\r\n                    </div>\r\n                </form>\r\n            </div>\r\n        </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport auth from '@/assets/auth';\r\nimport 'vue-good-table/dist/vue-good-table.css';\r\nimport { VueGoodTable } from 'vue-good-table';\r\nimport Multiselect from 'vue-multiselect';\r\n\r\nexport default {\r\n  name: 'CouponsManagement',\r\n  components: { VueGoodTable, Multiselect },\r\n  data() {\r\n    return {\r\n      couponToEdit: null,\r\n      couponsList: [],\r\n      usersList: [],\r\n      speakersList: [],\r\n      columns: [\r\n        {\r\n          label: 'Coupon',\r\n          field: 'coupon_title',\r\n        },\r\n        {\r\n          label: 'Discount %',\r\n          field: 'discount',\r\n        },\r\n        {\r\n          label: 'Recipient',\r\n          field: 'recipient_name',\r\n        },\r\n        {\r\n          label: 'For guests?',\r\n          field: this.guestCheck,\r\n        },\r\n        {\r\n          label: 'Invitation type',\r\n          field: 'invitation_type',\r\n        },\r\n        {\r\n          label: 'Invitation display',\r\n          field: this.headlinersCheck,\r\n        },\r\n        {\r\n          label: 'Max uses',\r\n          field: 'max_uses',\r\n        },\r\n        {\r\n          label: 'Actual uses',\r\n          field: 'actual_uses',\r\n        },\r\n        {\r\n          label: 'View/Edit',\r\n          field: 'edit',\r\n        },\r\n      ],\r\n    };\r\n  },\r\n  methods: {\r\n    async grabCoupons() {\r\n      this.couponsList = [];\r\n      const url = auth.allCoupons;\r\n      const headers = {\r\n        credentials: 'same-origin',\r\n        'Content-Type': 'application/json',\r\n        'X-WP-Nonce': this.nonce,\r\n      };\r\n      fetch(url, { method: 'GET', headers })\r\n        .then((result) => result.json())\r\n        .then((result) => { this.couponsList = result; });\r\n    },\r\n    async grabUsers() {\r\n      this.usersList = [];\r\n      const url = auth.peopleAndOrgs;\r\n      const headers = {\r\n        credentials: 'same-origin',\r\n        'Content-Type': 'application/json',\r\n        'X-WP-Nonce': this.nonce,\r\n      };\r\n      fetch(url, { method: 'GET', headers })\r\n        .then((result) => result.json())\r\n        .then((result) => { this.usersList = result; });\r\n    },\r\n    async grabSpeakers() {\r\n      this.usersList = [];\r\n      const url = auth.onlyPeople;\r\n      const headers = {\r\n        credentials: 'same-origin',\r\n        'Content-Type': 'application/json',\r\n        'X-WP-Nonce': this.nonce,\r\n      };\r\n      fetch(url, { method: 'GET', headers })\r\n        .then((result) => result.json())\r\n        .then((result) => { this.speakersList = result; });\r\n    },\r\n    guestCheck(rowObj) {\r\n      if (rowObj.guest_status === '1') {\r\n        return 'Yes';\r\n      }\r\n      return 'No';\r\n    },\r\n    headlinersCheck(rowObj) {\r\n      if (rowObj.headliners.length >= 1) {\r\n        return 'Custom';\r\n      }\r\n      return 'Standard';\r\n    },\r\n    editCoupon(rowId) {\r\n      this.couponToEdit = this.couponsList[rowId];\r\n    },\r\n    startNewCoupon() {\r\n      this.couponToEdit = {};\r\n    },\r\n  },\r\n  mounted() {\r\n    this.grabCoupons();\r\n    this.grabUsers();\r\n    this.grabSpeakers();\r\n  },\r\n\r\n};\r\n</script>\r\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}