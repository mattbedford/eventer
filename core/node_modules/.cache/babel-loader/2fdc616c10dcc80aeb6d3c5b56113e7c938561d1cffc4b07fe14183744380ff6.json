{"ast":null,"code":"import auth from '@/assets/auth';\nimport 'vue-good-table/dist/vue-good-table.css';\nimport { VueGoodTable } from 'vue-good-table';\nexport default {\n  name: 'SetUp',\n  components: {\n    VueGoodTable\n  },\n  data() {\n    return {\n      oneToEdit: null,\n      registrationsList: [],\n      columns: [{\n        label: 'Name',\n        field: this.concatName\n      }, {\n        label: 'Email',\n        field: 'email'\n      }, {\n        label: 'Company',\n        field: 'company'\n      }, {\n        label: 'Coupon',\n        field: 'coupon_code'\n      }, {\n        label: 'Paid',\n        field: this.paidAmount\n      }, {\n        label: 'Printed',\n        field: this.printedOrNot\n      }, {\n        label: 'Registered',\n        field: this.registrationDate\n      }, {\n        label: 'View/Edit',\n        field: 'edit'\n      }]\n    };\n  },\n  methods: {\n    async grabRegistrations() {\n      const url = auth.allRegistrations;\n      const headers = {\n        credentials: 'same-origin',\n        'Content-Type': 'application/json',\n        'X-WP-Nonce': this.nonce\n      };\n      fetch(url, {\n        method: 'GET',\n        headers\n      }).then(result => result.json()).then(result => {\n        this.registrationsList = result;\n      });\n    },\n    async editRegistration(cmd) {\n      this.oneToEdit.command = cmd;\n      const data = JSON.stringify(this.oneToEdit);\n      const url = auth.editRegistrations;\n      const headers = {\n        credentials: 'same-origin',\n        'Content-Type': 'application/json',\n        'X-WP-Nonce': this.nonce\n      };\n      fetch(url, {\n        method: 'POST',\n        headers,\n        body: data\n      }).then(this.oneToEdit = null).then(result => result.json()).then(result => {\n        this.announce = result;\n      }); //NEED TO INCLUDE MSG ANNUONCE COMPONENT\n    },\n\n    editButton(rowObj) {\n      const z = rowObj.id;\n      const x = `<button @click=\"editRegistrant(${z})\">View/Edit</button>`;\n      return x;\n    },\n    concatName(rowObj) {\n      return rowObj.name + ' ' + rowObj.surname;\n    },\n    paidAmount(rowObj) {\n      return 'CHF ' + rowObj.paid;\n    },\n    printedOrNot(rowObj) {\n      if (rowObj.printed === '0') {\n        return 'No';\n      }\n      return 'Yes';\n    },\n    editRegistrant(rowId) {\n      this.oneToEdit = this.registrationsList[rowId];\n    },\n    registrationDate(rowObj) {\n      const s = rowObj.sign_up_date;\n      return s.split('-').reverse().join('-');\n    }\n  },\n  mounted() {\n    this.grabRegistrations();\n  }\n};","map":{"version":3,"mappings":"AAsGA;AACA;AACA;AAEA;EAEAA;EACAC;IACAC;EACA;EACAC;IACA;MACAC;MACAC;MACAC,UACA;QACAC;QACAC;MACA,GACA;QACAD;QACAC;MACA,GACA;QACAD;QACAC;MACA,GACA;QACAD;QACAC;MACA,GACA;QACAD;QACAC;MACA,GACA;QACAD;QACAC;MACA,GACA;QACAD;QACAC;MACA,GACA;QACAD;QACAC;MACA;IAEA;EACA;EACAC;IACA;MACA;MACA;QACAC;QACA;QACA;MACA;MACAC;QAAAC;QAAAC;MAAA,GACAC,8BACAA;QAAA;MAAA;IACA;IACA;MACA;MACA;MACA;MACA;QACAJ;QACA;QACA;MACA;MACAC;QAAAC;QAAAC;QAAAE;MAAA,GACAD,4BACAA,8BACAA;QAAA;MAAA;IACA;;IACAE;MACA;MACA;MACA;IACA;IACAC;MACA;IACA;IACAC;MACA;IACA;IACAC;MACA;QACA;MACA;MACA;IACA;IACAC;MACA;IACA;IACAC;MACA;MACA;IACA;EACA;EACAC;IACA;EACA;AACA","names":["name","components","VueGoodTable","data","oneToEdit","registrationsList","columns","label","field","methods","credentials","fetch","method","headers","then","body","editButton","concatName","paidAmount","printedOrNot","editRegistrant","registrationDate","mounted"],"sourceRoot":"src/components","sources":["RegistrationsList.vue"],"sourcesContent":["<template>\r\n  <div class=\"sub-section\">\r\n    <div class=\"registrations-table\">\r\n        <vue-good-table\r\n            :columns=\"columns\"\r\n            :rows=\"registrationsList\"\r\n            theme=\"black-rhino\"\r\n            :search-options=\"{\r\n              enabled: true\r\n            }\"\r\n            :pagination-options=\"{\r\n                enabled: true,\r\n                perPage: 50,\r\n                position: 'bottom',\r\n            }\">\r\n            <template slot=\"table-row\" slot-scope=\"props\">\r\n                <span v-if=\"props.column.field == 'edit'\">\r\n                    <button @click=\"editRegistrant(props.row.originalIndex)\">Edit</button>\r\n                </span>\r\n            </template>\r\n        </vue-good-table>\r\n    </div>\r\n    <div class=\"edit-shelf\" v-if=\"oneToEdit\" v-scroll-lock=\"oneToEdit\">\r\n      <div class=\"content-wrap\">\r\n        <span class=\"options-title\">\r\n          <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"ionicon\" viewBox=\"0 0 512 512\"><path d=\"M459.94 53.25a16.06 16.06 0 0 0-23.22-.56L424.35 65a8 8 0 0 0 0 11.31l11.34 11.32a8 8 0 0 0 11.34 0l12.06-12c6.1-6.09 6.67-16.01.85-22.38zM399.34 90 218.82 270.2a9 9 0 0 0-2.31 3.93L208.16 299a3.91 3.91 0 0 0 4.86 4.86l24.85-8.35a9 9 0 0 0 3.93-2.31L422 112.66a9 9 0 0 0 0-12.66l-9.95-10a9 9 0 0 0-12.71 0z\"/><path d=\"M386.34 193.66 264.45 315.79A41.08 41.08 0 0 1 247.58 326l-25.9 8.67a35.92 35.92 0 0 1-44.33-44.33l8.67-25.9a41.08 41.08 0 0 1 10.19-16.87l122.13-121.91a8 8 0 0 0-5.65-13.66H104a56 56 0 0 0-56 56v240a56 56 0 0 0 56 56h240a56 56 0 0 0 56-56V199.31a8 8 0 0 0-13.66-5.65z\"/></svg>\r\n          <h2>Edit registration</h2>\r\n        </span>\r\n\r\n        <button class=\"close-button\" @click=\"(oneToEdit = null)\">\r\n          <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"ionicon\" viewBox=\"0 0 512 512\"><path fill=\"none\" stroke=\"currentColor\" stroke-miterlimit=\"10\" stroke-width=\"32\" d=\"M448 256c0-106-86-192-192-192S64 150 64 256s86 192 192 192 192-86 192-192z\"/><path fill=\"none\" stroke=\"currentColor\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"32\" d=\"M320 320 192 192m0 128 128-128\"/></svg>\r\n        </button>\r\n        <form id=\"edit-registrant\">\r\n\r\n          <h2>User contacts</h2>\r\n          <input type=\"hidden\" v-model=\"oneToEdit.id\">\r\n          <div class=\"double\">\r\n            <label for=\"fname\">First name\r\n              <input type=\"text\" id=\"fname\" v-model=\"oneToEdit.name\"/></label>\r\n\r\n            <label for=\"lname\">Last name\r\n              <input type=\"text\" id=\"lname\" v-model=\"oneToEdit.surname\"/></label>\r\n          </div>\r\n\r\n          <div class=\"double\">\r\n            <label for=\"company\">Company\r\n              <input type=\"text\" id=\"company\" v-model=\"oneToEdit.company\"/></label>\r\n\r\n            <label for=\"website\">Website\r\n              <input type=\"url\" id=\"website\" v-model=\"oneToEdit.website\"/></label>\r\n          </div>\r\n\r\n          <label for=\"role\">Role\r\n              <input type=\"text\" id=\"role\" v-model=\"oneToEdit.role\"/></label>\r\n\r\n          <label for=\"email\">Email address\r\n              <input type=\"email\" id=\"email\" v-model=\"oneToEdit.email\"/></label>\r\n\r\n          <div>\r\n            <label for=\"mobile\">Mobile phone\r\n              <input type=\"text\" id=\"company\" v-model=\"oneToEdit.mobile_phone\"/></label>\r\n\r\n            <label for=\"office\">Office phone\r\n              <input type=\"text\" id=\"office\" v-model=\"oneToEdit.office_phone\"/></label>\r\n          </div>\r\n\r\n          <h2>Address</h2>\r\n          <label for=\"address\">Address\r\n            <input type=\"text\" id=\"address\" v-model=\"oneToEdit.street_address\"/></label>\r\n          <label for=\"city\">City\r\n            <input type=\"text\" id=\"city\" v-model=\"oneToEdit.city\"/></label>\r\n          <label for=\"country\">Country\r\n            <input type=\"text\" id=\"country\" v-model=\"oneToEdit.country\"/></label>\r\n\r\n          <h2>Sign-up details</h2>\r\n          <ul>\r\n            <li>Coupon: <strong>{{oneToEdit.coupon_code}}</strong></li>\r\n            <li>Billed: <strong>CHF {{oneToEdit.paid}}</strong></li>\r\n            <li>Payment status: <strong>{{oneToEdit.payment_status}}</strong></li>\r\n            <li>Sign-up date: <strong><span v-html=\"registrationDate(oneToEdit)\">\r\n            </span></strong></li>\r\n            <li>User interests: <strong>{{oneToEdit.interests.replaceAll(',', ', ')}}</strong></li>\r\n          </ul>\r\n\r\n          <button\r\n            class=\"save-edits form-button\"\r\n            type=\"button\" @click=\"editRegistration('save')\">\r\n            Save edits\r\n          </button>\r\n          <button\r\n            class=\"delete-registration form-button\"\r\n            type=\"button\"\r\n            @click=\"editRegistration('kill')\">\r\n            Delete registration\r\n          </button>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport auth from '@/assets/auth';\r\nimport 'vue-good-table/dist/vue-good-table.css';\r\nimport { VueGoodTable } from 'vue-good-table';\r\n\r\nexport default {\r\n\r\n  name: 'SetUp',\r\n  components: {\r\n    VueGoodTable,\r\n  },\r\n  data() {\r\n    return {\r\n      oneToEdit: null,\r\n      registrationsList: [],\r\n      columns: [\r\n        {\r\n          label: 'Name',\r\n          field: this.concatName,\r\n        },\r\n        {\r\n          label: 'Email',\r\n          field: 'email',\r\n        },\r\n        {\r\n          label: 'Company',\r\n          field: 'company',\r\n        },\r\n        {\r\n          label: 'Coupon',\r\n          field: 'coupon_code',\r\n        },\r\n        {\r\n          label: 'Paid',\r\n          field: this.paidAmount,\r\n        },\r\n        {\r\n          label: 'Printed',\r\n          field: this.printedOrNot,\r\n        },\r\n        {\r\n          label: 'Registered',\r\n          field: this.registrationDate,\r\n        },\r\n        {\r\n          label: 'View/Edit',\r\n          field: 'edit',\r\n        },\r\n      ],\r\n    };\r\n  },\r\n  methods: {\r\n    async grabRegistrations() {\r\n      const url = auth.allRegistrations;\r\n      const headers = {\r\n        credentials: 'same-origin',\r\n        'Content-Type': 'application/json',\r\n        'X-WP-Nonce': this.nonce,\r\n      };\r\n      fetch(url, { method: 'GET', headers })\r\n        .then((result) => result.json())\r\n        .then((result) => { this.registrationsList = result; });\r\n    },\r\n    async editRegistration(cmd) {\r\n      this.oneToEdit.command = cmd;\r\n      const data = JSON.stringify(this.oneToEdit);\r\n      const url = auth.editRegistrations;\r\n      const headers = {\r\n        credentials: 'same-origin',\r\n        'Content-Type': 'application/json',\r\n        'X-WP-Nonce': this.nonce,\r\n      };\r\n      fetch(url, { method: 'POST', headers, body: data })\r\n        .then(this.oneToEdit = null)\r\n        .then((result) => result.json())\r\n        .then((result) => { this.announce = result; }); //NEED TO INCLUDE MSG ANNUONCE COMPONENT\r\n    },\r\n    editButton(rowObj) {\r\n      const z = rowObj.id;\r\n      const x = `<button @click=\"editRegistrant(${z})\">View/Edit</button>`;\r\n      return x;\r\n    },\r\n    concatName(rowObj) {\r\n      return rowObj.name + ' ' + rowObj.surname;\r\n    },\r\n    paidAmount(rowObj) {\r\n      return 'CHF ' + rowObj.paid;\r\n    },\r\n    printedOrNot(rowObj) {\r\n      if (rowObj.printed === '0') {\r\n        return 'No';\r\n      }\r\n      return 'Yes';\r\n    },\r\n    editRegistrant(rowId) {\r\n      this.oneToEdit = this.registrationsList[rowId];\r\n    },\r\n    registrationDate(rowObj) {\r\n      const s = rowObj.sign_up_date;\r\n      return s.split('-').reverse().join('-');\r\n    },\r\n  },\r\n  mounted() {\r\n    this.grabRegistrations();\r\n  },\r\n};\r\n</script>\r\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}